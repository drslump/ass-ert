<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Combinators - ass-ert documentation</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> ass-ert documentation</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
            <li class="toctree-l1 ">
                <a class="" href="../styles">Styles</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../failures">Failures</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../composability">Composability</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../mutation">Mutation</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../negation">Negation</a>
            </li>
        

    
        
            <li class="toctree-l1 current">
                <a class="current" href=".">Combinators</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../quantifiers">Quantifiers</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../async">Async</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../interoperability">Interoperability</a>
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../troubleshooting">Troubleshooting</a>
            </li>
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href=".."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    <li>Combinators</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/drslump/ass-ert" class="icon icon-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="combinators">Combinators</h1>
<p>As your data structures get more complex <strong>ass</strong> won't be left behind.
Coordinate expressions with <strong>or</strong> / <strong>and</strong> to fully express the assertion by
composition.</p>
<blockquote>
<p>Note: fluent <em>expectation</em> chaining is implicitly evaluated as <strong>and</strong>.</p>
</blockquote>
<pre><code class="js">ass(data).or(
  ass.string,
  ass.number.lessThan(12),
  ass.array.and(
    ass.size.equal(2),
    ass.contains('foo')
  )
)
</code></pre>

<p>Since some <em>expectations</em> will mutate the value for the rest of the <em>expression</em>,
sometimes we may wish to go back to a previous version of the value. By using
the <code>.and</code> combinator we can achieve that and express complex assertions with
ease:</p>
<pre><code class="js">// Note: pluck mutates the value to be the one of the specific property for
//       all elements in the array.
ass(data).array.and(
  ass.size.above(10).below(100),
  ass.pluck('name').every.string.and(
    ass.not.empty,
    ass.match(/^[A-Z]/)
  ),
  ass.filter( ass.pluck('age').above(18) ).and(
    ass.size.is( ass.below(8) ),
    ass.all.prop('adult').true
  ).store(result, 'adults')  // this sets the intermediate value in result.adults
);
</code></pre>

<p>Here we've seen the power of composition, we've defined an <em>expression</em> that
would certainly be quite a bit more complex if we did it in an <em>imperative</em>
programming style. It takes a bit of effort to get familiar with the syntax but
once you do it's hard to go back. Not only did the assertion get simpler but
it should hopefully produce easy to understand failure messages.</p>
<p>Of course, this example was a little bit oriented towards testing, but the only
thing that produces an assertion error is the <code>ass(data).</code> at the beginning, we
could simply use <code>ass.</code> and pass the value at the end of the <em>expression</em> with
<code>.test(data)</code> to get a boolean result. Even more, using <code>.tap(fn)</code> we can inject
our logic anywhere in the expression and evaluate or mutate the values as they
pass through, while with <code>.store()</code> we can keep the intermediate results around
for further analysis.</p>

            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../quantifiers" class="btn btn-neutral float-right" title="Quantifiers"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../negation" class="btn btn-neutral" title="Negation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
            <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
        
      <span><a href="../negation" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../quantifiers" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>